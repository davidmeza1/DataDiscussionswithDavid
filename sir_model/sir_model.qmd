---
title: "SIR Model"
author: "David Meza"
format: html
server: shiny
---

## Shiny Documents

This Quarto document is made interactive using Shiny. Interactive documents allow readers to modify parameters and see the results immediately. Learn more about Shiny interactive documents at <https://quarto.org/docs/interactive/shiny/>.

## Inputs and Outputs

You can embed Shiny inputs and outputs in your document. Outputs are automatically updated whenever inputs change. This demonstrates how a standard R plot can be made interactive:

```{r}
sliderInput("S0", "Enter Initial Susceptible Pop:", 
            min = 0, max = 200, value = 100)
sliderInput("tmax", "Enter number of days:", 
            min = 0, max = 100, value = 60)
sliderInput("betain", "Enter value for alpha:", 
            min = 0, max = .100, value = .002)
sliderInput("gammain", "Enter value for gamma:", 
            min = 0, max = 1, value = .04)
plotOutput("matPlot")
```

```{r}
#| context: server

library(deSolve)
sir <- function(time, state, parameters) {
  with(as.list(c(state, parameters)), {
    dS <- -beta * S * I
    dI <- beta * S * I - gamma * I
    dR <- gamma * I
    
    return(list(c(dS, dI, dR)))
  })
}

output$matPlot <- renderPlot({
  S0 <- input$S0
  tmax <- input$tmax
  betain <- input$betain
  gammain <- input$gammain

  parameters <- c(beta = betain, gamma = gammain)
  init <- c(S = S0-1, I = 1, 0.0)

  times <- seq(0, tmax, by = 0.25)
  out <- as.data.frame(ode(y = init, times = times, func = sir, parms = parameters))
  out$time <- NULL
  
  matplot(times, out, type = "l", xlab = "Time", ylab = "Susceptibles and Recovereds",  lwd = 1, lty = 1, bty = "l", col = c(4,3,2))
  legend(.8*tmax, .7*S0, c("Susceptibles", "Infecteds", "Recovereds"), pch = 1, col = c(4,3,2))
  titleparms <- expression(paste("SIR Model: (", alpha, ",", gamma, ")"))
  subparms <- paste("(", betain,",",gammain,")")
  title(main=titleparms)
  mtext(subparms,side=3)
})
```
